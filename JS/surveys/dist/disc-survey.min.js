const surveyData={surveyID:1,page:window.location.pathname,action:"http://localhost:5000/surveys",title:"Страничный опрос",btnText:"ПРОЙТИ ОПРОС",questions:[{question:"Насколько были <b>понятны</b> материалы данной дисциплины?",name:"q1",type:"radio",output:"inline",answers:["1","2","3","4","5"]},{question:"Какой информации по дисциплине Вам не хватает?",name:"q2",type:"radio",output:"block",answers:["Примеров решения","Практических материалов","Теоретических материалов","Требований к дисциплине","Другое"]},{question:"Встретились ли Вам ошибки/недочеты на данной странице?",name:"q3",type:"radio",output:"inline",answers:["0","1"]},{question:"Подскажите, что можно исправить/улучшить на данной странице?",name:"q4",type:"textarea",output:"block"}]};function createSurveyBtn(e){let t=document.createElement("button");return t.innerHTML=e,t.setAttribute("id","btnSurvey"),t}function createRootModal(){let e=document.createElement("div");return e.setAttribute("id","modalSurvey"),e.className="modal",e}function createModalContent(){return content=document.createElement("form"),content.setAttribute("id","modalContent"),content.className="modal-content",content}function createHiddenInput(e,t){let n=document.createElement("input");return n.setAttribute("type","text"),n.setAttribute("name",e),n.setAttribute("hidden","true"),n.setAttribute("value",t),n}function createSurveyClose(){let e=document.createElement("span");return e.setAttribute("id","clsSurvey"),e.className="close",e.innerHTML="&times;",e}function createSurveyTitle(e){var t=document.createElement("h3");return e.innerHTML=e,t}function surveyBuilder(e){let r=createSurveyBtn(e.btnText);document.body.prepend(r);let o=createRootModal(),u=createModalContent();o.append(u);var t=createHiddenInput("surveyID",e.surveyID);u.append(t);t=createHiddenInput("page",e.page);u.append(t);let n=createSurveyClose();u.append(n);var i,t=createSurveyTitle(e.title);u.append(t);for(i of e.questions){let e=document.createElement("p");e.innerHTML=i.question,u.append(e);let a;if("radio"==i.type)if(a=document.createElement("input"),a.setAttribute("type","radio"),a.setAttribute("name",i.name),a.setAttribute("required","true"),"block"==i.output)for(var d of i.answers){let e=document.createElement("div"),t=a.cloneNode();t.setAttribute("value",d),e.append(t),e.append(d),u.append(e)}else{let r=document.createElement("div");r.className="row";let o=document.createElement("div");o.className="col";for(var c of i.answers){let e=o.cloneNode(),t=a.cloneNode();t.setAttribute("value",c),t.innerHTML="";let n=document.createElement("p");n.innerHTML=c,e.append(t),e.append(n),r.append(e)}u.append(r)}if("textarea"==i.type){let e=document.createElement("div");a=document.createElement("textarea"),a.setAttribute("rows","3"),a.setAttribute("name",i.name),e.append(a),u.append(e)}}let a=document.createElement("p"),l=document.createElement("button");l.setAttribute("type","reset"),l.innerHTML="Очистить",a.append(l);let s=document.createElement("button");s.setAttribute("type","submit"),s.setAttribute("id","btnSubmit"),s.innerHTML="Отправить",a.append(s),u.append(a),document.body.append(o),r.addEventListener("click",()=>{o.style.display="block"}),n.addEventListener("click",()=>{o.style.display="none"}),window.addEventListener("click",()=>{event.target==o&&(o.style.display="none")}),u.addEventListener("submit",e=>{e.preventDefault();const t=new XMLHttpRequest;let n=new FormData(u);n.append("uniqueID","1"),t.addEventListener("load",e=>{console.log(e.target.responseText)}),t.addEventListener("error",e=>{console.log("Oops! Something went wrong.")}),t.open("POST","http://localhost:5000/surveys"),t.send(n),u.innerHTML="<h2>Ваш ответ отправлен.<br>Спасибо за участие!</h2>",setTimeout(()=>{o.style.display="none",r.style.display="none"},1e3)})}function checkUniqueID(){const e=getCookie("uniqueID");null==e&&(e=localStorage.getItem("uniqueID"))}function getCookie(e){e=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}surveyBuilder(surveyData);